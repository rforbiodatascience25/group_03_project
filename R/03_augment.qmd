---
title: "03_augment"
format: html
editor: visual
---

## Load libraries

```{r}
library(tidyverse)
library(tibble)
library(readr)
library(dplyr)
```

## Time to add our new genes

Before we had a metadata table, now we will add 15 new genes based on the paper (Pawlikowski JS, McBryan T, van Tuyn J, Drotar ME et al. Wnt signaling potentiates nevogenesis. Proc Natl Acad Sci U S A 2013 Oct 1;110(40):16009-14. PMID:Â [24043806](https://www.ncbi.nlm.nih.gov/pubmed/24043806 "Link to PubMed record"))

-   5 down regulated genes

    -   WIPF1, CD8A, CD2, ELK1 and CD3E

-   5 up regulated genes

    -   MAPK1, LFT, SOCS1, RELB and GNB4

-   5 non modified genes

    -   TRIM44, UGT2B7, TCP1, ORC1L and NEK1

### First, we load the gene expression matrix

```{r}
setwd("..")
gene_expression <- read_tsv("data/expression_data.tsv")
head(gene_expression)
```

We need to filter this table for the genes of interest previously mentioned only..

Oh no! we find out that we don't have the real gene name, but the illumina gene ID. Lucky for us, we have a table that will help us with that

### Then, we load the previous gene table

So we can find the real gene name based on the ILMN gene name

```{r}
setwd("..")
gene_names <- read_tsv("data/platform_table_clean.tsv")
show(gene_names)
```

### Gene expression data formatting

Some of this gene names have more than 1 illumina gene identifier, so lets obtain an average gene expression for these gene names

```{r}
#Sum and divide values from expression_data
#After, delete repeated rows 
#Show clean expression_data
```

Change name rows from ILMN_gene to real Gene_ID

```{r}
#ILMN_gene -> Gene_ID
```

And pivot data so samples are rows instead of cols

```{r}
#Pivot_wider
```

Ok, now the expression_data is in format!

Now merge all data...

```{r}
#Merge original metadata_table with expression_data based on sample name 
```

### Final data visualization

```{r}
show(final_data)
```
