---
title: "01_load"
format: html
editor: visual
---

## Library loading

```{r}
library(GEOquery)
library(dplyr)
library(tibble)
```

## Running Code

Downloading of all the data we need.

```{r}

gse <- getGEO("GSE54514", GSEMatrix = TRUE)

# If multiple platforms, take the first one
gse <- gse[[1]]

# Inspect
exprs_data <- exprs(gse)
pheno_data <- pData(gse)
feature_data <- fData(gse)

```

load raw_data

```{r}

# Download full SOFT file (untidy)
gse_raw <- getGEO("GSE54514", GSEMatrix = FALSE)

# Extract all samples
gsms <- GSMList(gse_raw)

# Extract raw metadata (untidy)
meta_untidy <- lapply(gsms, function(gsm) {
  tibble(
    sample = Meta(gsm)$geo_accession,           # Correct way to get sample ID
    characteristics = Meta(gsm)$characteristics_ch1  # untidy fields
  )
}) |> bind_rows()

```

